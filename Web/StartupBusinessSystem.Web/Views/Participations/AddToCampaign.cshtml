@model StartupBusinessSystem.Web.ViewModels.Participations.CreateParticipationViewModel
@{
    ViewBag.Title = "AddToCampaign";
}

<h2>Make Offer to @Model.Name</h2>

<h2>Current Shares @Model.CurrentShares from @Model.TotalShares</h2>

<div class="progress progress-striped active">
    <div class="progress-bar" style="width:@((Model.CurrentShares*100)/Model.TotalShares)%"></div>
</div>

@using (Html.BeginForm("AddToCampaign", "Participations", FormMethod.Post, new { @class = "form-horizontal", role = "form" }))
{
    @Html.AntiForgeryToken()
    <hr />
    if (!ViewData.ModelState.IsValid)
    {
        <div class="alert alert-danger" role="alert">
            <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
            <span class="sr-only">Error:</span>
            @Html.ValidationSummary(true)
        </div>
    }

    <div class="form-group">
        @Html.LabelFor(m => m.MakeOffer, new { @class = "col-md-2 control-label" })
        <div class="col-md-10">
            @Html.TextBoxFor(m => m.MakeOffer, new { oninput = "calculate(" + Model.PricePerShare + ", " + Model.CurrentShares + ")", id = "first", @class = "form-control" })
            @Html.ValidationMessageFor(m => m.MakeOffer)
        </div>
    </div>
    <div class="form-group">
        <label class="col-md-2 control-label">Total Price:</label>
        <div class="col-md-3">
            <div id="showResult" class="form-control"></div>
        </div>
    </div>
    <div class="form-group">
        <div class="col-md-offset-2 col-md-10">
            <input type="submit" class="btn btn-default" id="submit-button" value="Make Offer" />
        </div>
    </div>
}

@section Scripts {
    @Scripts.Render("~/bundles/jqueryval")

    <script>
        function calculate(pricePerShare, maxPrice) {
            let sum = document.getElementById("first").value;
            let calck = parseInt(sum);
            let result = calck * pricePerShare;
            makeButtonInactive(maxPrice);
            if (!isNaN(result)) {
                document.getElementById("showResult").innerHTML = result;
            }
        }

        function makeButtonInactive(maxPrice) {
            let sum = document.getElementById("first").value;
            let calck = parseInt(sum);
            if (calck < 1 || calck > maxPrice) {
                document.getElementById("submit-button").disabled = true;
            } else {
                document.getElementById("submit-button").disabled = false;
            }

        }
    </script>
}
